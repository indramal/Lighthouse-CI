<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lighthouse Report Summary</title>
    <style>
      body {
        background-color: black;
        color: white;
      }
      table {
        border-collapse: collapse;
        width: 100%;
      }
      table,
      th,
      td {
        border: 1px solid white;
      }
      th,
      td {
        padding: 8px;
        text-align: center;
      }
      .red-text {
        color: red;
      }
      .yellow-text {
        color: yellow;
      }
      .green-text {
        color: green;
      }
      a {
        color: white;
        text-decoration: none; /* Remove underlines from links */
      }
    </style>
  </head>
  <body>
    <h1>Lighthouse Report Summary</h1>
    <table>
      <thead>
        <tr>
          <th>URL</th>
          <th>Performance</th>
          <th>Accessibility</th>
          <th>Best Practices</th>
          <th>SEO</th>
          <th>PWA</th>
          <th>Report</th>
        </tr>
      </thead>
      <tbody id="reportTableBody">
        <!-- Table rows will be generated here -->
      </tbody>
    </table>

    <script>
      fetch("manifest.json")
        .then((response) => response.json())
        .then((data) => {
          const tableBody = document.getElementById("reportTableBody");

          data.forEach((entry) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                        <td><a href="${entry.url}" target="_blank">${
              entry.url
            }</a></td>
                        <td class="${getColorClass(
                          entry.summary.performance
                        )}">${entry.summary.performance}</td>
                        <td class="${getColorClass(
                          entry.summary.accessibility
                        )}">${entry.summary.accessibility}</td>
                        <td class="${getColorClass(
                          entry.summary["best-practices"]
                        )}">${entry.summary["best-practices"]}</td>
                        <td class="${getColorClass(entry.summary.seo)}">${
              entry.summary.seo
            }</td>
                        <td class="${getColorClass(entry.summary.pwa)}">${
              entry.summary.pwa
            }</td>
                        <td><a href="${getReportFileName(
                          entry.htmlPath
                        )}" target="_blank">Report</a></td>
                    `;
            tableBody.appendChild(row);
          });
        });

      function getColorClass(value) {
        if (value < 0.8) {
          return "red-text";
        } else if (value < 0.9) {
          return "yellow-text";
        } else {
          return "green-text";
        }
      }

      function getReportFileName(reportUrl) {
        // Split the report URL by "/" and return the last part (the file name)
        const parts = reportUrl.split("/");
        return parts[parts.length - 1];
      }
    </script>
  </body>
</html>
